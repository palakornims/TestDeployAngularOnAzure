    
    name: Docker Build and Push to ACR

    on:
      push:
        branches:
          - main

    jobs:
      build-and-push:
        runs-on: ubuntu-latest
        steps:
          - name: Checkout code
            uses: actions/checkout@v3

          - name: Azure Login
            uses: azure/login@v1
            with:
              creds: ${{ secrets.AZURE_CREDENTIALS }}

          - name: Build and Push Docker Image
            uses: mr-smithers-excellent/docker-build-push@v6
            with:
              image: ${{ secrets.ACR_LOGIN_SERVER }}/${{ github.repository }}
              tags: latest
              registry: ${{ secrets.ACR_LOGIN_SERVER }}
              username: ${{ secrets.ACR_USERNAME }}
              password: ${{ secrets.ACR_PASSWORD }}
              dockerfile: Dockerfile
